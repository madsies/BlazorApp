@page "/Login"
@using System.Text.RegularExpressions
@rendermode InteractiveServer

<div id="LoginBox">
    <h1>@loginTextToggle[createAccountToggle ? 1 : 0]</h1>
    <button @onclick="toggleMode">@toggleText[createAccountToggle ? 1 : 0]</button>
    <div id="Inputs">
        <p>Username</p>
        <input type="text" @bind="usernameInput"/>

        @if (createAccountToggle)
        {
            <p>Email</p>
            <input type="text" @bind="emailInput"/>
        }

        <p>Password</p>
        <input type="password" @bind="passwordInput"/>

    </div>
    <p id="ErrorText">@errorAlert</p>
    <button @onclick="onClickCreate">Confirm</button>
    
</div>

@code
{
    public string usernameInput = "";
    public string emailInput = "";
    public string passwordInput= "";

    public bool createAccountToggle;
    public string[] loginTextToggle = {"Login", "Create Account"};
    public string[] toggleText = {"Create Account", "Have an account already?"};

    public string errorAlert = "";

    public void toggleMode()
    {
        createAccountToggle = !createAccountToggle;
    }
    /*
        Checks length, numbers, etc.
    */

    public bool checkPasswordStrength(string password)
    {
        // Length Check
        if (password.Length < 8) return false;

        // Includes Digit
        Regex r = new Regex(".*[0-9].*");
        if (!r.IsMatch(password)) return false;

        // Valid Password
        return true;
    }

    public bool checkValidEmailFormat(string email)
    {
        Regex r = new Regex(@"^((\w+([-+.]?\w+)*@\w+([-.]?\w+)*\.\w+([-.]?\w+)*)\s*[;]{0,1}\s*)+$");
        if (!r.IsMatch(email)) return false;
        return true;
    }

    public void onClickLogin()
    {
        
        
    }

    public void onClickCreate()
    {
        errorAlert = "";
        if (!checkValidEmailFormat(emailInput)) errorAlert += "Invalid Email.\n";
        if (!checkPasswordStrength(passwordInput)) errorAlert += "Password too weak!\n";
        
        if (errorAlert == "") errorAlert = "Valid Password";
    }
}